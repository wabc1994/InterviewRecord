# 内存泄漏和内存溢出

## 什么是内存泄漏

就是有部分内存使用完了，却没有正常释放给系统，
>内存泄露是指无用对象（不再使用的对象）持续占有内存或无用对象的内存得不到及时释放，从而造成的内存空间的浪费称为内存泄露


### 什么情况下会导致内存泄漏
长生命周期的对象持有短生命周期对象的引用就很可能发生内存泄露，尽管短生命周期对象已经不再需要，但是因为长生命周期对象持有它的引用而导致不能被回收，这就是java中内存泄露的发生场景

[造成内存泄漏的原因主要可以分为以下几种情况](https://www.cnblogs.com/wzyxidian/p/5860473.html)

(长生命周期对短申明周期的引用，导致段生明周期的对象占用的内存不能正常释放开来)
## 内存溢出

内存溢出：指程序运行过程中无法申请到足够的内存而导致的一种错误。

## 内存泄漏和内存溢出的关系，不是唯一因素
内存泄露是内存溢出的一种诱因，

起上一篇线上应用故障排查之一：高CPU占用介绍的PS命令，ps,top,等命令都是分析系统性能的常用的命令行

最后，总结下排查内存故障的方法和技巧有哪些：

1、top命令：Linux命令。可以查看实时的内存使用情况。  

2、jmap -histo:live [pid]，然后分析具体的对象数目和占用内存大小，从而定位代码。

3、jmap -dump:live,format=b,file=xxx.xxx [pid]，然后利用MAT工具分析是否存在内存泄漏等等。

# Java运行参数设置
Heap Size 最大最好不要超过可用物理内存的80％。建议将-Xms和-Xmx选项设置为相同，而-Xmn为1/4的-Xmx值。


-Xms：初始值 
-Xmx：最大值 
-Xmn：最小值